# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1LbP2cKs3lL6y8Z8Bq_GTE6o8hVnMG-CV
"""

import requests
import pandas as pd

# poe2.ninja APIì—ì„œ ì•„ì´í…œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
url = "https://poe.ninja/api/data/itemoverview?league=Ancestor&type=UniqueWeapon"

response = requests.get(url)
data = response.json()

# ì•„ì´í…œ ë°ì´í„° ì •ë¦¬
items = data['lines']

# ìƒìœ„ 10ê°œ ì•„ì´í…œë§Œ ë³´ê¸° ì¢‹ê²Œ ì¶œë ¥
df = pd.DataFrame(items)
df[['name', 'chaosValue', 'icon']].head(10)

# HTML í…Œì´ë¸”ë¡œ ë³´ê¸° ì¢‹ê²Œ ë§Œë“¤ê¸°
html_table = "<table border='1' style='border-collapse: collapse; text-align: center;'>"
html_table += "<tr><th>ì•„ì´í…œ ì´ë¦„</th><th>ì¹´ì˜¤ìŠ¤ ê°€ê²©</th><th>ì•„ì´ì½˜</th></tr>"

for index, row in df.head(10).iterrows():
    html_table += f"<tr>"
    html_table += f"<td>{row['name']}</td>"
    html_table += f"<td>{round(row['chaosValue'], 2)}</td>"
    html_table += f"<td><img src='{row['icon']}' width='40'></td>"
    html_table += f"</tr>"

html_table += "</table>"

# ê²°ê³¼ ì¶œë ¥
print(html_table)

import requests

# --- ì—¬ê¸°ì— ë„ˆì˜ ë´‡ í† í°ê³¼ ì±„íŒ… ID ë„£ê¸° ---
BOT_TOKEN = '8038373130:AAEwhUIQu5fxmqMP-nBx-dNes00GA6hWlnQ'
CHAT_ID = '7595444442'

# --- ë©”ì„¸ì§€ ì „ì†¡ í•¨ìˆ˜ ---
def send_telegram_message(html):
    send_url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendMessage"
    payload = {
        'chat_id': CHAT_ID,
        'text': html,
        'parse_mode': 'HTML',
        'disable_web_page_preview': False
    }
    res = requests.post(send_url, data=payload)
    return res.json()

# --- html_tableì„ ì „ì†¡! ---
send_telegram_message(html_table)

import requests

# --- ì—¬ê¸°ì— ë„ˆì˜ ë´‡ í† í°ê³¼ ì±„íŒ… ID ë„£ê¸° ---
BOT_TOKEN = '8038373130:AAEwhUIQu5fxmqMP-nBx-dNes00GA6hWlnQ'
CHAT_ID = '7595444442'

# --- ë©”ì„¸ì§€ ì „ì†¡ í•¨ìˆ˜ ---
def send_telegram_message(html):
    send_url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendMessage"
    payload = {
        'chat_id': CHAT_ID,
        'text': html,
        'parse_mode': 'HTML',
        'disable_web_page_preview': False
    }
    res = requests.post(send_url, data=payload)
    return res.json()

# --- html_tableì„ ì „ì†¡! ---
send_telegram_message(html_table)

html_table = "<table border='1' style='border-collapse: collapse; text-align: center;'>"
html_table += "<tr><th>ì•„ì´í…œ ì´ë¦„</th><th>ì¹´ì˜¤ìŠ¤ ê°€ê²©</th><th>ì•„ì´ì½˜</th></tr>"

for index, row in df.head(10).iterrows():
    html_table += f"<tr>"
    html_table += f"<td>{row['name']}</td>"
    html_table += f"<td>{round(row['chaosValue'], 2)}</td>"
    html_table += f"<td><img src='{row['icon']}' width='40'></td>"
    html_table += f"</tr>"

html_table += "</table>"

import requests
import pandas as pd

# poe2.ninja APIì—ì„œ ì¸ê¸° ì•„ì´í…œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
url = "https://poe.ninja/api/data/itemoverview?league=Ancestor&type=UniqueWeapon"
response = requests.get(url)
data = response.json()

# ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜
items = data['lines']
df = pd.DataFrame(items)

html_table = "<table border='1' style='border-collapse: collapse; text-align: center;'>"
html_table += "<tr><th>ì•„ì´í…œ ì´ë¦„</th><th>ì¹´ì˜¤ìŠ¤ ê°€ê²©</th><th>ì•„ì´ì½˜</th></tr>"

for index, row in df.head(10).iterrows():
    html_table += f"<tr>"
    html_table += f"<td>{row['name']}</td>"
    html_table += f"<td>{round(row['chaosValue'], 2)}</td>"
    html_table += f"<td><img src='{row['icon']}' width='40'></td>"
    html_table += f"</tr>"

html_table += "</table>"

send_telegram_message(html_table)

import requests

# --- ì—¬ê¸°ì— ë„ˆì˜ ë´‡ í† í°ê³¼ ì±„íŒ… ID ë„£ê¸° ---
BOT_TOKEN = '8038373130:AAEwhUIQu5fxmqMP-nBx-dNes00GA6hWlnQ'
CHAT_ID = '7595444442'

# --- ë©”ì„¸ì§€ ì „ì†¡ í•¨ìˆ˜ ---
def send_telegram_message(html):
    send_url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendMessage"
    payload = {
        'chat_id': CHAT_ID,
        'text': html,
        'parse_mode': 'HTML',
        'disable_web_page_preview': False
    }
    res = requests.post(send_url, data=payload)
    return res.json()

# --- html_tableì„ ì „ì†¡! ---
send_telegram_message(html_table)

# í…ìŠ¤íŠ¸ë¡œ ìš”ì•½í•´ì„œ ë³´ë‚´ê¸°
message = "ğŸ”¥ ì˜¤ëŠ˜ì˜ ì¸ê¸° ìœ ë‹ˆí¬ ë¬´ê¸° Top 5 ğŸ”¥\n\n"

for index, row in df.head(5).iterrows():
    message += f"{index+1}. {row['name']} - {round(row['chaosValue'], 2)} chaos\n"

send_telegram_message(message)

